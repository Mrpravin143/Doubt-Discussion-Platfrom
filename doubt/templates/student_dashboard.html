{% extends "base.html" %}
{% block start %}

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">

<!-- AOS CSS -->
<link href="https://cdn.jsdelivr.net/npm/aos@2.3.4/dist/aos.css" rel="stylesheet">

<style>
  html {
    scroll-behavior: smooth;
  }
  body {
    font-family: 'Poppins', sans-serif;
    background-color: #f9fafc;
    color: #333;
  }

  /* Global Accent Gradient */
  .gradient-bg {
    background: linear-gradient(90deg, #4facfe, #00f2fe);
    color: white !important;
  }

  /* Navbar */
  .navbar {
    background: #ffffff;
    box-shadow: 0 4px 15px rgba(0,0,0,0.08);
  }
  .navbar-brand {
    color: #004e92 !important;
    font-weight: 700;
  }
  .nav-link {
    font-weight: 600;
    color: #004e92 !important;
  }
  .nav-link:hover { 
    color: #ff6f61 !important;
  }

  /* Avatar Circle */
  .avatar-circle {
    width: 42px; height: 42px;
    border-radius: 50%;
    background-color: #4facfe;
    color: white;
    font-weight: 700;
    font-size: 1rem;
    display: flex; align-items: center; justify-content: center;
    text-transform: uppercase;
    cursor: pointer;
  }

  /* Hero Section */
  #hero {
    background: linear-gradient(90deg, #4facfe, #00f2fe);
    color: white;
    padding: 5rem 0;
    border-radius: 0 0 50px 50px;
  }
  #hero h1 { font-weight: 800; }

  .btn-lg {
    font-weight: 700;
    border-radius: 50px;
    transition: all 0.3s ease;
  }

  /* Doubt Cards */
  .doubt-card-custom {
    background: #fff;
    color: #333;
    border-radius: 15px;
    padding: 25px;
    min-height: 280px;
    transition: all 0.3s ease;
    border: 1px solid #e9ecef;
  }
  .doubt-card-custom:hover {
    transform: translateY(-6px);
    box-shadow: 0 12px 20px rgba(0,0,0,0.08);
  }

  /* Counter */
  #counter .card {
    border-radius: 20px;
    background: #ffffff;
    border: 1px solid #e9ecef;
    color: #004e92;
  }
  .counter-value {
    font-size: 2.5rem;
    font-weight: 800;
    color: #ff6f61;
  }

  /* Features */
  #features .list-group-item {
    background: #fff;
    color: #004e92;
    border-radius: 12px;
    margin-bottom: 12px;
    border: 1px solid #e9ecef;
    font-weight: 500;
  }

  /* Footer */
  .footer {
    background: #f1f5f9;
    color: #333;
    padding: 20px;
    text-align: center;
    font-weight: 600;
    border-top: 1px solid #e5e7eb;
  }

  .search-icon {
    position: absolute;
    top: 50%;
    left: 10px;
    transform: translateY(-50%);
    color: gray;
  }
  .search-input { padding-left: 2.5rem; }
</style>

<!-- Navbar -->
<nav class="navbar navbar-expand-lg sticky-top py-2" data-aos="fade-down">
  <div class="container-fluid px-4">
    <!-- Brand -->
    <a class="navbar-brand text-white fw-bold" href="#">
      <i class="fas fa-graduation-cap me-2"></i>Doubt<span class="text-warning">2</span>Solve
    </a>

    <!-- Toggler -->
    <button class="navbar-toggler bg-white" type="button" data-bs-toggle="collapse" data-bs-target="#navbarContent">
      <span class="navbar-toggler-icon"></span>
    </button>

    <!-- Nav Items -->
    <div class="collapse navbar-collapse" id="navbarContent">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0">
        <!-- Home -->
        <li class="nav-item">
          <a class="nav-link" href="{% url 'student_dashboard' %}">
            <i class="fas fa-home me-1"></i> Home
          </a>
        </li>

        <!-- Ask Doubts -->
        <li class="nav-item">
          <a class="nav-link" href="{% url 'ask_doubts' %}">
            <i class="fas fa-question-circle me-1"></i> Ask Doubts
          </a>
        </li>

        <!-- Profile -->
        <li class="nav-item">
          <a class="nav-link" href="{% url 'profile_view' %}">
            <i class="fas fa-user me-1"></i> Profile
          </a>
        </li>

        <!-- Features Toggle -->
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown">
            <i class="fas fa-star me-1"></i> Features
          </a>
          <ul class="dropdown-menu">
            {% for feature in features %}
            <li><a class="dropdown-item" href="#features"><i class="fas fa-check-circle me-2 text-success"></i>{{ feature.name }}</a></li>
            {% endfor %}
          </ul>
        </li>
      </ul>

      <!-- Right Side -->
      {% if user.is_authenticated %}
        <!-- Avatar Dropdown -->
        <div class="dropdown">
          <a class="avatar-circle" href="#" id="userDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            {% with user.first_name|default:'' as fname %}
              {% with user.last_name|default:'' as lname %}
                {{ fname|slice:":1" }}{{ lname|slice:":1" }}
              {% endwith %}
            {% endwith %}
          </a>
          <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="userDropdown">
            <li><a class="dropdown-item" href="{% url 'profile_view' %}"><i class="fas fa-user-circle me-2"></i> Profile</a></li>
            <li><a class="dropdown-item" href="{% url 'user_logout' %}"><i class="fas fa-sign-out-alt me-2"></i> Logout</a></li>
          </ul>
        </div>
      {% else %}
        <a class="btn btn-light me-2" href="{% url 'login_user' %}"><i class="fas fa-sign-in-alt me-1"></i> Login</a>
        <a class="btn btn-warning" href="{% url 'login_user' %}"><i class="fas fa-plus-circle me-1"></i> Ask Doubts</a>
      {% endif %}
    </div>
  </div>
</nav>

<!-- Hero Section -->
<section id="hero" class="text-center text-lg-start" data-aos="fade-up">
  <div class="container">
    <div class="row align-items-center">
      <div class="col-lg-6 mb-4">
        <h1>"Every doubt you solve brings you closer to clarity."</h1>
        <p>Doubt2Solve is your academic companion. Ask, solve, and grow together.</p>
        <a href="#recent-doubts" class="btn btn-light btn-lg me-2"><i class="fas fa-search me-2"></i> Browse Doubts</a>
        <a href="{% if user.is_authenticated  %}{% url 'ask_doubts' %}{% else %}{% url 'login_user' %}{% endif%}" class="btn btn-outline-light btn-lg">
          <i class="fas fa-plus-circle me-2"></i> Ask a Doubt
        </a>
      </div>
      <div class="col-lg-6 text-center" data-aos="zoom-in">
        {% for logos in logo %}
        <img src="{{logos.logo.url}}" alt="Logo" class="img-fluid hero-logo">
        {% endfor %}
      </div>
    </div>
  </div>
</section>

<!-- Newest Doubts -->
<div class="container py-5" data-aos="fade-up">
  <h3 class="fw-bold text-center text-primary"><i class="fas fa-bolt me-2"></i> Newest Doubts</h3>
  <div class="row g-4">
    {% for doubt in doubts %}
    <div class="col-md-6 col-lg-4" data-aos="zoom-in">
      <div class="doubt-card-custom">
        <h5><i class="fas fa-question me-2"></i>{{ doubt.decrypted_name }}</h5>
        <p>{{ doubt.decrypted_description|truncatewords:20 }}</p>
        <small><i class="fas fa-user me-1"></i>{{ doubt.user }}</small>
      </div>
    </div>
    {% endfor %}
  </div>
</div>

<!-- Counter -->
<section id="counter" class="py-5" data-aos="fade-up">
  <div class="container">
    <div class="row g-4">
      <div class="col-md-4" data-aos="flip-left">
        <div class="card p-4 text-center">
          <h2 class="counter-value" data-target="{{ student_count }}"><i class="fas fa-user-graduate me-2"></i>0</h2>
          <p>Students Registered</p>
        </div>
      </div>
      <div class="col-md-4" data-aos="flip-up">
        <div class="card p-4 text-center">
          <h2 class="counter-value" data-target="{{ teacher_count }}"><i class="fas fa-chalkboard-teacher me-2"></i>0</h2>
          <p>Teachers Registered</p>
        </div>
      </div>
      <div class="col-md-4" data-aos="flip-right">
        <div class="card p-4 text-center">
          <h2 class="counter-value" data-target="{{ solved_count }}"><i class="fas fa-check-circle me-2"></i>0</h2>
          <p>Problems Solved</p>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- Features -->
<div id="features" class="container py-5" data-aos="fade-up">
  <div class="card shadow-lg border-0 rounded-3">
    <!-- Header with toggle -->
    <div class="card-header d-flex justify-content-between align-items-center gradient-bg text-white p-3 rounded-top">
      <h4 class="mb-0 fw-bold">
        <i class="fas fa-star me-2"></i> Project Features
      </h4>
      <button class="btn btn-light btn-sm rounded-circle shadow-sm" type="button" data-bs-toggle="collapse" data-bs-target="#featuresList" aria-expanded="false" aria-controls="featuresList">
        <i class="fas fa-chevron-down"></i>
      </button>
    </div>

    <!-- Collapse body -->
    <div id="featuresList" class="collapse show mt-3">
      <ul class="list-group list-group-flush">
        {% for feature in features %}
        <li class="list-group-item d-flex align-items-center" data-aos="fade-right">
          <i class="fas fa-check-circle text-success me-2"></i> {{ feature.name }}
        </li>
        {% endfor %}
      </ul>
    </div>
  </div>
</div>

<!-- Upcoming Features Section -->
<div class="container py-5" id="upcoming" data-aos="fade-up">
  <h2 class="text-center gradient-title mb-5" data-aos="zoom-in">
    ðŸš€ Upcoming Features
  </h2>
  
  <div class="row g-4">
    <!-- ChatBots -->
    <div class="col-md-4" data-aos="fade-up">
      <div class="team-card text-center p-4">
        <div class="icon-circle mb-3 mx-auto">
          <i class="fas fa-robot fa-2x"></i>
        </div>
        <h5 class="fw-bold mb-2">Smart ChatBots</h5>
        <p class="text-muted">
          AI-powered ChatBots to help you get instant answers to your doubts anytime.
        </p>
      </div>
    </div>

    <!-- Auto Detect Spam Doubts -->
    <div class="col-md-4" data-aos="fade-up" data-aos-delay="200">
      <div class="team-card text-center p-4">
        <div class="icon-circle mb-3 mx-auto green">
          <i class="fas fa-shield-alt fa-2x"></i>
        </div>
        <h5 class="fw-bold mb-2">Auto Detect Spam Doubts</h5>
        <p class="text-muted">
          Advanced filters & AI to automatically detect spam or irrelevant questions.
        </p>
      </div>
    </div>

    <!-- Real-Time Chatting -->
    <div class="col-md-4" data-aos="fade-up" data-aos-delay="400">
      <div class="team-card text-center p-4">
        <div class="icon-circle mb-3 mx-auto orange">
          <i class="fas fa-comments fa-2x"></i>
        </div>
        <h5 class="fw-bold mb-2">Real-time Chatting</h5>
        <p class="text-muted">
          Chat live with teachers & peers with real-time updates using WebSockets.
        </p>
      </div>
    </div>
  </div>
</div>

<!-- Footer -->
<footer class="footer" data-aos="fade-up">
  <i class="fas fa-lightbulb me-2"></i>&copy; 2025 Doubt2Solve. All rights reserved.
</footer>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<!-- AOS JS -->
<script src="https://cdn.jsdelivr.net/npm/aos@2.3.4/dist/aos.js"></script>
<script>
  AOS.init({
    duration: 1000,
    once: true
  });
</script>
{% endblock %}
