{% extends "base.html" %}
{% block start %}

<style>
  body {
    background: linear-gradient(120deg, #000428, #004e92);
    font-family: 'Poppins', sans-serif;
    color: white;
  }

  /* Navbar */
  .navbar {
    background: rgba(0,0,0,0.6) !important;
    backdrop-filter: blur(10px);
  }
  .navbar .nav-link {
    color: #fff !important;
  }
  .navbar .nav-link:hover {
    color: #facc15 !important;
  }

  /* Sidebar */
  .sidebar {
    background: rgba(255,255,255,0.1);
    backdrop-filter: blur(10px);
    border-radius: 12px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.4);
    color: white;
  }
  .sidebar h5 {
    font-weight: 700;
    color: #facc15;
  }
  .sidebar .nav-link {
    color: white;
    padding: 6px 10px;
    border-radius: 8px;
  }
  .sidebar .nav-link:hover {
    background: rgba(255,255,255,0.15);
  }

  /* Profile Card */
  .card {
    background: rgba(255,255,255,0.12);
    backdrop-filter: blur(14px);
    border: none;
    border-radius: 18px;
    color: white;
  }

  .card h3 {
    font-weight: 700;
    color: #38bdf8;
  }

  .progress {
    background: rgba(255,255,255,0.2);
    border-radius: 12px;
    overflow: hidden;
  }
  .progress-bar {
    font-weight: bold;
    font-size: 14px;
  }

  /* Table */
  .table {
    color: white;
  }
  .table th {
    background: rgba(255,255,255,0.15) !important;
    color: #facc15;
    font-weight: 600;
  }
  .table-hover tbody tr:hover {
    background: rgba(255,255,255,0.1);
  }

  /* Badges */
  .badge {
    font-weight: 500;
  }

  /* Modal */
  .modal-content {
    background: rgba(255,255,255,0.9);
    color: #111;
    border-radius: 12px;
  }
  .modal-header {
    border-bottom: none;
  }
  .modal-footer {
    border-top: none;
  }
</style>


<!-- Navbar -->
<nav class="navbar navbar-expand-lg sticky-top py-2">
  <div class="container-fluid px-4">
    <a class="navbar-brand fw-bold text-white" href="#">
      Doubt<span class="text-warning">2</span>Solve
    </a>

    <button class="navbar-toggler bg-white" type="button" data-bs-toggle="collapse" data-bs-target="#navbarContent">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse" id="navbarContent">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0">
        <li class="nav-item"><a class="nav-link" href="{% url 'student_dashboard' %}">Home</a></li>
        <li class="nav-item"><a class="nav-link" href="{% url 'ask_doubts' %}">Ask Doubts</a></li>
        <li class="nav-item"><a class="nav-link" href="#team">Team</a></li>
      </ul>

      {% if user.is_authenticated %}
      <div class="dropdown">
        <a class="btn btn-light rounded-circle text-uppercase fw-bold d-flex align-items-center justify-content-center"
           href="#" id="userDropdown" data-bs-toggle="dropdown" aria-expanded="false"
           style="width: 40px; height: 40px;">
          {{ user.first_name|slice:":1" }}{{ user.last_name|slice:":1" }}
        </a>
        <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="userDropdown">
          <li><a class="dropdown-item" href="{% url 'profile_view' %}">Profile</a></li>
          <li><a class="dropdown-item" href="{% url 'user_logout' %}">Logout</a></li>
        </ul>
      </div>
      {% else %}
      <a class="btn btn-light me-2" href="{% url 'login_user' %}">Ask Doubts</a>
      {% endif %}
    </div>
  </div>
</nav>


<div class="container py-4">
  <div class="row">
    <!-- Sidebar -->
    <div class="col-lg-3 col-md-4 mb-4">
      <div class="sidebar p-3">
        <h5 class="text-center mb-3">EMS</h5>
        <ul class="nav flex-column">
          <li class="nav-item"><a class="nav-link" href="{% url 'ask_doubts' %}">Ask Doubts</a></li>
          <li class="nav-item"><a class="nav-link" href="{% url 'student_dashboard' %}">Home</a></li>
        </ul>
      </div>
    </div>

    <!-- Profile Content -->
    <div class="col-lg-9 col-md-8">
      <div class="card shadow-lg mb-4">
        <div class="card-body p-4">

          <div class="d-flex justify-content-between align-items-center flex-wrap mb-3">
            <div>
              <h3>{{ request.user.first_name }} {{ request.user.last_name }}</h3>
              <p class="text-light"><i class="bi bi-envelope-at-fill me-1"></i>{{ request.user }}</p>
            </div>
            <button class="btn btn-outline-light rounded-pill" data-bs-toggle="modal" data-bs-target="#editProfileModal">
              <i class="bi bi-pencil-square me-1"></i> Edit Profile
            </button>
          </div>

          <hr>

          <div class="mb-4">
            <h6>Profile Completion</h6>
            <div class="progress" style="height: 20px;">
              <div class="progress-bar progress-bar-striped progress-bar-animated bg-success" role="progressbar" style="width: 100%;">
                100%
              </div>
            </div>
          </div>

          <div class="table-responsive mb-4">
            <table class="table table-hover table-bordered rounded-3">
              <tbody>
                <tr><th>ðŸ“› Full Name</th><td>{{ request.user.first_name }} {{ request.user.last_name }}</td></tr>
                <tr><th>ðŸ“§ Email</th><td>{{ request.user }}</td></tr>
                <tr><th>ðŸŽ¯ Interest</th><td>{{ profile.intrest }}</td></tr>
                <tr><th>ðŸš€ Future Goal</th><td>{{ profile.future_goals }}</td></tr>
              </tbody>
            </table>
          </div>

          <div class="mb-4">
            <h5><i class="bi bi-person-lines-fill me-2"></i>About Me</h5>
            <p class="fst-italic">{{ profile.about_me }}</p>
          </div>

          <div class="card shadow-sm">
            <div class="card-body">
              <h5><i class="bi bi-stars me-2 text-warning"></i>Skills</h5>
              <div class="d-flex flex-wrap gap-2">
                <span class="badge rounded-pill bg-primary px-3 py-2">{{ profile.Skills }}</span>
              </div>
            </div>
          </div>

        </div>
      </div>
    </div>
  </div>
</div>


<!-- Modal -->
<div class="modal fade" id="editProfileModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-lg modal-dialog-scrollable">
    <div class="modal-content">
      <form method="post">
        {% csrf_token %}
        <div class="modal-header">
          <h5 class="modal-title">Edit Profile</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body row g-3">
          <div class="col-md-6"><label class="form-label">First Name</label><input type="text" name="first_name" class="form-control" value="{{ user.first_name }}"></div>
          <div class="col-md-6"><label class="form-label">Last Name</label><input type="text" name="last_name" class="form-control" value="{{ user.last_name }}"></div>
          <div class="col-md-6"><label class="form-label">Email</label><input type="email" name="email" class="form-control" value="{{ user.email }}"></div>
          <div class="col-md-6"><label class="form-label">Interest</label><input type="text" name="interest" class="form-control" value="{{ profile.intrest }}"></div>
          <div class="col-md-6"><label class="form-label">Future Goal</label><input type="text" name="future_goals" class="form-control" value="{{ profile.future_goals }}"></div>
          <div class="col-12"><label class="form-label">About Me</label><textarea class="form-control" name="about_me" rows="3">{{ profile.about_me }}</textarea></div>
          <div class="col-12"><label class="form-label">Skills</label><textarea class="form-control" name="skills" rows="3">{{ profile.Skills }}</textarea></div>
        </div>
        <div class="modal-footer">
          <button type="submit" class="btn btn-success">Save</button>
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
        </div>
      </form>
    </div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
{% endblock %}
