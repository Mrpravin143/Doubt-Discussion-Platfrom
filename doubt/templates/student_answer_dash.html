{% extends "base.html" %}
{% block start %}

<div class="container py-5">
  <h2 class="text-center mb-5 fw-bold text-primary">üìò My Doubts & Answers</h2>

  <div class="accordion" id="doubtAccordion">
    {% for d in doubts %}
      <div class="accordion-item border-0 shadow-sm mb-4 rounded-3 overflow-hidden">
        <h2 class="accordion-header" id="heading{{ forloop.counter }}">
          <button class="accordion-button collapsed bg-white fw-semibold text-dark" 
                  type="button" 
                  data-bs-toggle="collapse" 
                  data-bs-target="#collapse{{ forloop.counter }}" 
                  aria-expanded="false" 
                  aria-controls="collapse{{ forloop.counter }}">
            <i class="bi bi-question-circle me-2 text-primary"></i> 
            {{ d.get_decrypted_name }}
          </button>
        </h2>

        <div id="collapse{{ forloop.counter }}" 
             class="accordion-collapse collapse" 
             aria-labelledby="heading{{ forloop.counter }}" 
             data-bs-parent="#doubtAccordion">
          <div class="accordion-body bg-light">
            
            <p class="mb-2"><b>Description:</b> {{ d.get_decrypted_description }}</p>
            
            {% if d.doubt_image %}
              <div class="mb-3">
                <img src="{{ d.doubt_image.url }}" class="img-fluid rounded shadow-sm"/>
              </div>
            {% endif %}

            <h6 class="text-success fw-bold mt-4 mb-3">üí° Answers:</h6>
            {% for ans in d.answers.all %}
              <div class="border rounded-3 p-3 mb-3 bg-white shadow-sm">
                <p class="mb-2">{{ ans.answer_text }}</p>
                {% if ans.answer_file %}
                  <a href="{{ ans.answer_file.url }}" 
                     class="btn btn-sm btn-outline-primary rounded-pill px-3" download>
                    <i class="bi bi-download"></i> Download File
                  </a>
                {% endif %}
                <small class="text-muted d-block mt-2">
                  ‚úç By <span class="fw-semibold">{{ ans.teacher.first_name }} {{ ans.teacher.last_name }}</span> 
                  ‚Ä¢ {{ ans.created_at|date:"M d, Y H:i" }}
                </small>
              </div>
            {% empty %}
              <p class="text-muted fst-italic">No answers yet.</p>
            {% endfor %}
          </div>
        </div>
      </div>
    {% endfor %}
  </div>
</div>

<!-- Bootstrap Icons CDN -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet">

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

{% endblock %}
