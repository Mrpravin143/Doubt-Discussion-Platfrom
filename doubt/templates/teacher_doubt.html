{% extends "base.html" %}
{% block start %}

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">

<style>
  body {
    font-family: 'Poppins', sans-serif;
    background-color: #f8fafc;
  }
  .doubt-container {
    display: flex;
    height: 80vh;
    border-radius: 12px;
    overflow: hidden;
    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
  }
  /* Sidebar */
  .doubt-list {
    width: 30%;
    background: #1e293b;
    color: #fff;
    overflow-y: auto;
  }
  .doubt-list .nav-link {
    color: #fff;
    border-bottom: 1px solid rgba(255,255,255,0.1);
    padding: 15px;
    text-align: left;
  }
  .doubt-list .nav-link:hover, .doubt-list .nav-link.active {
    background: #334155;
    font-weight: bold;
  }
  .doubt-meta {
    font-size: 12px;
    color: #cbd5e1;
    margin-top: 4px;
    display: block;
  }
  /* Details */
  .doubt-details {
    flex: 1;
    background: #ffffff;
    padding: 20px;
    overflow-y: auto;
  }
  .doubt-details h4 {
    color: #1e293b;
    font-weight: 600;
  }
  .doubt-details img {
    max-height: 220px;
    object-fit: contain;
  }
</style>

<div class="container py-4">
  <h2 class="text-center mb-4">Assigned Doubts</h2>

  <div class="doubt-container">
    <!-- Left Sidebar -->
    <div class="doubt-list nav flex-column nav-pills" id="v-pills-tab" role="tablist" aria-orientation="vertical">
      {% for d in doubts %}
        <button class="nav-link {% if forloop.first %}active{% endif %}" 
                id="v-pills-{{d.id}}-tab" 
                data-bs-toggle="pill" 
                data-bs-target="#v-pills-{{d.id}}" 
                type="button" role="tab" aria-controls="v-pills-{{d.id}}" 
                aria-selected="{% if forloop.first %}true{% else %}false{% endif %}">
          <h6 class="m-0">{{ d.get_decrypted_name|truncatechars:30 }}</h6>
          <small class="text-light d-block">{{ d.get_decrypted_description|truncatechars:40 }}</small>
          <span class="doubt-meta">
            üìÖ {{ d.created_at|date:"M d, Y" }} | ‚è∞ {{ d.created_at|time:"h:i A" }}
          </span>
        </button>
      {% empty %}
        <p class="p-3">No doubts assigned yet.</p>
      {% endfor %}
    </div>

    <!-- Right Details -->
    <div class="doubt-details tab-content" id="v-pills-tabContent">
      {% for d in doubts %}
        <div class="tab-pane fade {% if forloop.first %}show active{% endif %}" 
             id="v-pills-{{d.id}}" role="tabpanel" aria-labelledby="v-pills-{{d.id}}-tab">
          <h4>{{ d.get_decrypted_name }}</h4>
          <p>{{ d.get_decrypted_description }}</p>
          {% if d.doubt_image %}
            <img src="{{ d.doubt_image.url }}" class="img-fluid rounded mb-3"/>
          {% endif %}
          <br>
          <a href="{% url 'answer_doubt' d.id %}" class="btn btn-success">
            <i class="fa fa-reply"></i> Answer
          </a>
        </div>
      {% endfor %}
    </div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
{% endblock %}
